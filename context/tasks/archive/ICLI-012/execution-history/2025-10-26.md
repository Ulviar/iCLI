# Execution History — ICLI-012 — 2025-10-26

- **Author:** Assistant (Codex)
- **Lifecycle stage:** Execution
- **Summary:** Implemented the ClientScheduler abstraction plus async helpers on CommandService/LineSessionClient, then removed the temporary coroutine wiring per new guidance and queued a follow-up task for a dedicated Kotlin module.

## Implementation notes
- Added `ClientScheduler` plus `ClientSchedulers` (virtual-thread default + executor wrapper) with cancel-aware `CompletableFuture`s. (`src/main/java/com/github/ulviar/icli/client/ClientScheduler.java`, `ClientSchedulers.java`)
- Extended `CommandService` to retain a scheduler, provide `runAsync` overloads, and feed the scheduler into `LineSessionClient`. (`src/main/java/com/github/ulviar/icli/client/CommandService.java`)
- Updated `LineSessionClient` to store the scheduler and expose `processAsync`. (`src/main/java/com/github/ulviar/icli/client/LineSessionClient.java`)
- Added `ImmediateClientScheduler` test helper plus scheduler/async unit tests. Removed the earlier coroutine adapters/tests/dependencies so Kotlin support can ship later as a separate module.

## Tests & verification
- `./gradlew spotlessApply` — ran to ensure Palantir/ktlint formatting after changes. (via `execute_gradle_task`)
- `./gradlew test` — full suite covering new scheduler + coroutine tests. (via `run_gradle_tests`)

## Documentation updates
- Dossier/backlog moved to Execution stage; coroutine behaviour already covered by the ICLI-007 decision, so no extra spec changes required beyond code-level docs.

## Follow-up & risks
- ProcessPoolClient async helpers remain outstanding (will be addressed when the pool is implemented).
- Streaming/listen-only Flow adapters are still tracked under TBD-003; today’s work supplies the scheduler foundation they will reuse.
- Added new backlog item ICLI-013 to cover a standalone Kotlin client module (coroutine bridges, Flow helpers, etc.).

## Retrospective & process improvement
- Definition of Done satisfied: scheduler + async APIs shipped; Kotlin work deferred to task ICLI-013 per maintainer request.
- Improvement idea: script dossier scaffolding (similar to earlier note) to trim the manual boilerplate when spinning up new tasks.

## Links
- Dossier: `context/tasks/ICLI-012/README.md`
